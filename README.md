 [戻る](https://github.com/PM2951/Python-forMAC)    
# Matplotlib (`plt`) 練習問題集

出典となる解説記事：

* 「Python入門とデータ処理の基礎 第3回 – Matplotlib/Seabornによるデータ可視化」をベースにした練習問題集です。  
  <https://www.salesanalytics.co.jp/datascience/datascience273>

すべて VS code (Jupyter Notebook) もしくは Google Colab を想定しています。

## 0. 準備コード

最初に、どの問題でも次のコードを 1 回だけ実行しておきます。

```python
import matplotlib.pyplot as plt
import japanize_matplotlib  # 日本語表示用（インストール済みを想定）
import numpy as np
```

※ `japanize_matplotlib` が入っていない場合は、ターミナルやノートブックで `pip install japanize-matplotlib matplotlib numpy` を実行してからインポートしてください。

※ 各大問の冒頭に使用するデータを記載しています。データをコピペして設問に解答してくだいさい。


---

## 問題1：病原体感染後の PR1 発現（折れ線グラフ）

Arabidopsis thaliana の葉に病原体（例：Pst DC3000）を接種し、経時的に **PR1 遺伝子の発現量**（qPCR 相対値）を測定したと仮定します。

### データ

```python
time_points = ['0 h', '1 h', '3 h', '6 h', '12 h', '24 h']
pr1_expr   = [1.0, 1.5, 3.2, 5.0, 4.0, 2.2]  # 相対発現量（0 h を 1 としたとき）
```

### やること

1. `plt.plot()` を使って、横軸に時間（`time_points`）、縦軸に PR1 の相対発現量（`pr1_expr`）をとった折れ線グラフを描きなさい。
2. タイトル・x軸ラベル・y軸ラベルを日本語で設定しなさい。

   * 例：タイトル「Pst 感染後の PR1 発現変化」、x軸「処理後時間 (h)」、y軸「PR1 相対発現量」など。
3. マーカー（点）を追加し、線の色や太さを自分で変更してください。
4. グリッド（目盛り線）を表示しなさい。

#### 発展（余裕があれば）

5. 各データ点の少し上に、`plt.text()` を使って「1.0」「1.5」のように値を表示しなさい。
6. `plt.ylim()` を使って、y軸の表示範囲を `[0, 6]` に変更しなさい。

---

## 問題2：変異体間の PR1 発現比較（棒グラフ）

Col-0 といくつかの防御応答変異体に SA 処理を行い、24 h 後の **PR1 発現量（fold change）** を qPCR で測定したと仮定します。

### データ

```python
genotypes = ['Col-0', 'npr1-1', 'sid2-2', 'eds1-2', 'wrky70']
pr1_fc    = [12.0,   1.5,      3.0,      4.5,      9.0]  # Mock = 1 に対する fold change
```

### やること

1. `plt.bar()` を使って、変異体ごとの PR1 発現量（fold change）の棒グラフを作りなさい。
2. タイトル・x軸ラベル・y軸ラベルを設定しなさい。

   * 例：タイトル「SA 処理 24 h 後の PR1 発現（変異体比較）」、x軸「遺伝子型」、y軸「PR1 fold change (対 Mock)」など。
3. 棒の色 (`color`) と枠線の色 (`edgecolor`) を指定して、見やすくしなさい。
4. y軸の範囲を 0〜15 に設定しなさい。

#### 発展（余裕があれば）

5. `for` 文と `plt.text()` を使って、各棒の上に「12.0」「1.5」のように値を表示しなさい。
6. 最も PR1 発現が高い遺伝子型（ここでは Col-0）の棒だけ、色を変えて強調してください。

---

## 問題3：防御関連遺伝子の機能カテゴリ（円グラフ）

RNA-seq 解析の結果、病原体感染で有意に発現変動した **防御関連遺伝子** を機能ごとに分類したと仮定します。

### データ

```python
categories = ['防御応答', '二次代謝', 'ホルモンシグナル', '酸化還元', '未知機能']
percent    = [40,       20,         15,               10,       15]  # 全体を100とした割合（％）
```

### やること

1. `plt.pie()` を使って、防御関連遺伝子の「機能カテゴリ」ごとの割合を表す円グラフを描きなさい。
2. `labels` 引数でカテゴリ名を表示しなさい。
3. `autopct='%1.1f%%'` を指定して、各セクションの割合を表示しなさい。
4. `startangle` を 90 にして、上から時計回りに表示されるようにしなさい。

#### 発展（余裕があれば）

5. 一番割合が大きい「防御応答」だけ少し飛び出させる（`explode`）設定を追加しなさい。
6. `plt.figure(figsize=(10, 8))` を使って、図のサイズを変更してください。

---

## 問題4：SA 濃度と PR1 発現量の関係（散布図）

Arabidopsis の培養細胞に異なる濃度のサリチル酸（SA）を処理し、数時間後の **PR1 発現量** を測定したと仮定します。

### データ

以下のコードで、SA 濃度と PR1 発現量のサンプルデータを作ります。

```python
np.random.seed(42)
sa_conc   = np.random.uniform(0, 500, 50)         # SA 濃度（µM）
pr1_expr  = 0.02 * sa_conc + np.random.normal(0, 2, 50)  # PR1 相対発現量
```

### やること

1. `plt.scatter()` を使って、SA 濃度（x軸）と PR1 発現量（y軸）の散布図を描きなさい。
2. タイトル・x軸ラベル・y軸ラベルを設定しなさい。

   * 例：タイトル「SA 濃度と PR1 発現量の関係」、x軸「SA 濃度 (µM)」、y軸「PR1 相対発現量」など。
3. 点の大きさ（`s`）と透明度（`alpha`）を変更して、重なりが見やすいように工夫しなさい。

#### 発展（余裕があれば）

4. `np.polyfit()` と `np.poly1d()` を使って、SA 濃度 → PR1 発現量の「傾向線（回帰直線）」を計算し、`plt.plot()` で散布図の上に描きなさい。
5. グリッドと凡例（`plt.legend()`）を追加しなさい。

---

## 問題5：RNA-seq の log2 fold change 分布（ヒストグラム）

病原体感染と Mock 処理を比較した RNA-seq から得られた、各遺伝子の **log2 fold change** の分布をヒストグラムで可視化する問題です。

### データ

```python
np.random.seed(123)
log2fc = np.random.normal(0, 1.2, 500)  # 感染 / Mock の log2 fold change を想定した分布
```

### やること

1. `plt.hist()` を使って、log2 fold change の分布のヒストグラムを描きなさい。
2. ビンの数（`bins`）を 30 に設定しなさい。
3. タイトル・x軸ラベル・y軸ラベルを設定しなさい。

   * 例：タイトル「RNA-seq の log2 fold change 分布」、x軸「log2 fold change (感染 / Mock)」、y軸「遺伝子数」など。
4. 棒の色・枠線の色・透明度（`alpha`）を指定して、見やすくしなさい。

#### 発展（余裕があれば）

5. `plt.axvline()` を使って、log2 fold change = 0（変化なし）の位置に縦線を引きなさい。
6. 上方制御（例：log2FC > 1）および下方制御（例：log2FC < -1）の遺伝子がわかりやすいようにそれぞれ色をかえてください。

---

## 問題6：複数遺伝子の時間経過発現をまとめて描く（subplot / axes）

1つの図（Figure）の中に、植物免疫で重要な複数遺伝子（例：**ICS1, PR1, WRKY70, CBP60g**）の時間経過発現をまとめて表示する練習です。病原体感染後の相対発現量を想定します。

### データ

```python
time_points = ['0 h', '1 h', '3 h', '6 h', '12 h', '24 h']
ics1_expr  = [1.0, 1.4, 2.5, 3.5, 3.0, 2.0]
pr1_expr   = [1.0, 1.8, 3.8, 5.5, 5.0, 4.0]
wrky70_expr= [1.0, 1.6, 3.0, 3.8, 3.2, 2.5]
cbp60g_expr= [1.0, 1.3, 2.2, 2.8, 2.6, 2.0]
```

### やること（1つの Axes に 4 本の折れ線）

1. `fig, ax = plt.subplots(figsize=(8, 4))` で Figure と Axes を作成しなさい。
2. `ax.plot()` を使って、ICS1, PR1, WRKY70, CBP60g の発現量を 1 つの Axes に重ねて描きなさい。

   * 4 本それぞれで、色（`color`）や線のスタイル（`linestyle`）、マーカー（`marker`）を変えて区別しなさい。
3. 凡例（`ax.legend()`）を追加しなさい。
4. タイトルと x軸・y軸のラベルを日本語で設定しなさい。

   * 例：タイトル「病原体感染後の防御関連遺伝子の発現変化」、x軸「処理後時間 (h)」、y軸「相対発現量（0 h = 1）」など。

### やること（subplot / axes で 4 つのグラフを並べる）

5. `fig, axes = plt.subplots(2, 2, figsize=(10, 8))` を使って、2 行 2 列に 4 つのグラフを並べる Figure を作りなさい。
6. それぞれの Axes に、対応する遺伝子の折れ線グラフを描きなさい。

   * `axes[0, 0]` に ICS1、`axes[0, 1]` に PR1、`axes[1, 0]` に WRKY70、`axes[1, 1]` に CBP60g。
7. 各 Axes に遺伝子名が分かるタイトル（例：「ICS1 の発現推移」）をつけなさい。
8. すべての Axes で y軸の範囲をそろえるために、`ax.set_ylim(0, 6)` のように同じ範囲を設定しなさい。

#### 発展（余裕があれば）

9. `fig.suptitle()` を使って、Figure 全体のタイトル（例：「病原体感染後の防御関連遺伝子（ICS1/PR1/WRKY70/CBP60g）の発現動態」）をつけなさい。
10. `plt.tight_layout()` や `fig.tight_layout()` を使って、ラベルやタイトルが重ならないようにレイアウトを調整しなさい。

---

